package io.joern.solidity2cpg.vulnerability

import io.joern.solidity2cpg.testfixtures.SolidityCodeToCpgFixture
import io.shiftleft.semanticcpg.language.{ICallResolver, NoResolve}

class Overflow extends SolidityCodeToCpgFixture{
  implicit  val resolver : ICallResolver = NoResolve
  override val code: String = {
  """
  |pragma solidity ^0.8.0;
  |
  |contract overflow {
  |    int sellerBalance = 0;
  |
  |    function add(int value) public  {
  |        sellerBalance += value; // possible overflow
  |    }
  |
  |    function safe_add(int value) public {
  |        require(value > sellerBalance, "Overflow");
  |        sellerBalance += value;
  |    }
  |}""".stripMargin
  }
  "should throw overflow" in {

  }
}
